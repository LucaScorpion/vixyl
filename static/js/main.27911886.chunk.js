(this.webpackJsonpvixyl=this.webpackJsonpvixyl||[]).push([[0],{104:function(e,t,n){},217:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(92),i=n.n(c),o=(n(104),n(12)),s=n.n(o),l=n(21),u=n(7),d=n(17),h=n(18);function j(e,t){return e.x===t.x&&e.y===t.y}var b=function(){function e(t){Object(d.a)(this,e),this.imageData=void 0,this.imageData=t.getImageData(0,0,t.canvas.width,t.canvas.height)}return Object(h.a)(e,[{key:"width",get:function(){return this.imageData.width}},{key:"height",get:function(){return this.imageData.height}},{key:"getPixel",value:function(e,t){var n,a,r;"object"===typeof(r=e)&&r&&"x"in r&&"y"in r&&"number"===typeof r.x&&"number"===typeof r.y?(n=e.x,a=e.y):(n=e,a=t||0);var c=4*(n+a*this.imageData.width),i=this.imageData.data.slice(c,c+4);return{red:i[0],green:i[1],blue:i[2],alpha:i[3]}}},{key:"isInBounds",value:function(e){return e.x>=0&&e.y>=0&&e.x<this.imageData.width&&e.y<this.imageData.height}}]),e}(),f=n(1),x=function(e){var t=e.icon,n=e.className;return Object(f.jsx)("i",{className:"fas fa-".concat(t," ").concat(n||"")})};function v(e,t){return"data:".concat(e,";base64,").concat(function(e){for(var t,n="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(e),c=r.byteLength,i=c%3,o=c-i,s=0;s<o;s+=3)n+=a[(16515072&(t=r[s]<<16|r[s+1]<<8|r[s+2]))>>18]+a[(258048&t)>>12]+a[(4032&t)>>6]+a[63&t];return 1==i?n+=a[(252&(t=r[o]))>>2]+a[(3&t)<<4]+"==":2==i&&(n+=a[(64512&(t=r[o]<<8|r[o+1]))>>10]+a[(1008&t)>>4]+a[(15&t)<<2]+"="),n}(t))}var g=function(e){var t=e.type,n=v(t,e.data);return 0===t.indexOf("audio/")?Object(f.jsx)("audio",{controls:!0,src:n,style:{width:"100%"}}):0===t.indexOf("image/")?Object(f.jsx)("img",{src:n,alt:""}):Object(f.jsx)("a",{download:"file",href:n,children:Object(f.jsxs)("button",{className:"big",children:["Download ",Object(f.jsx)(x,{icon:"download"})]})})},O=n(22),y=n(41),p=n(40),m=n(65);function w(e){return{red:e,green:e,blue:e,alpha:255}}function k(e){return{red:255&e,green:e>>8&255,blue:e>>16&255,alpha:255}}function N(e){return e.red+(e.green<<8)+(e.blue<<16)}function S(e,t,n,a){e.fillStyle="rgba(".concat(a.red,", ").concat(a.green,", ").concat(a.blue,", ").concat(a.alpha,")"),e.fillRect(t,n,1,1)}function R(e,t,n,a,r){e.fillStyle=r,e.beginPath(),e.arc(t,n,a,0,2*Math.PI),e.fill()}var I,A,C=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,[{key:"getEncodeForm",value:function(){return[{key:"addQr",type:"boolean",text:"Add QR code",defaultValue:!0},{key:"bgColor",type:"color",text:"Background color",defaultValue:{r:0,g:0,b:0}}]}},{key:"encode",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,r,c,i,o,l,u,d,h,j,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[k(t.type.length)].concat(Object(m.a)(t.type.split("").map((function(e){return w(e.charCodeAt(0))}))),[k(t.data.length)],Object(m.a)(this.getPixels(t.data))),r=this.createSpiral(a.length),c=2*r.radius+10,e.next=5,n.setCanvasProps({width:c,height:c});case 5:if((i=e.sent).clearRect(0,0,i.canvas.width,i.canvas.height),o={x:Math.round(i.canvas.width/2),y:Math.round(i.canvas.height/2)},l=n.form.bgColor,u=Math.min(null==l.a?1:l.a,.99),R(i,o.x,o.y,c/2,"rgba(".concat(l.r,", ").concat(l.g,", ").concat(l.b,", ").concat(u,")")),R(i,o.x,o.y,r.points[r.points.length-1].x-5,"white"),!n.form.addQr){e.next=16;break}return d=new Image,e.next=16,new Promise((function(e){d.addEventListener("load",(function(){i.drawImage(d,Math.round(o.x-d.width/2),Math.round(o.y-d.height/2)),e()})),d.src="/vixyl/qr.png"}));case 16:for(h=0;h<r.points.length;h++)j=r.points[h],S(i,j.x+o.x,j.y+o.y,a[h]);b=r.points[0],S(i,0,1,k(b.x+o.x)),S(i,1,1,k(b.y+o.y));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"decode",value:function(e){for(var t={x:N(e.getPixel(0,1)),y:N(e.getPixel(1,1))},n=this.readVinylTrack(e,t),a=N(n[0]),r="",c=0;c<a;c++)r="".concat(r).concat(String.fromCharCode(n[c+1].red));var i=N(n[a+1]);return{type:r,data:this.getBytes(n.slice(a+2)).slice(0,i)}}},{key:"createSpiral",value:function(e){var t,n=[],a=0,r=.1,c=30*Math.PI,i=this;function o(e){return!t||(j(e,t)?(r*=1.5,!1):!!i.isNeighbor(e,t)||(r/=2,!1))}for(var s=0;s<e;s++){for(var l=!1,u={x:0,y:0};!l;)l=o(u={x:Math.floor(.5*c*Math.cos(c+r)),y:Math.floor(.5*c*Math.sin(c+r))});s>1&&this.isNeighbor(n[s-2],u)&&delete n[s--];var d=Math.abs(u.x);d>a&&(a=d);var h=Math.abs(u.y);h>a&&(a=h),n[s]=u,t=u,c+=r}return{points:n.reverse(),radius:a}}},{key:"isNeighbor",value:function(e,t){return Math.abs(e.x-t.x)<=1&&Math.abs(e.y-t.y)<=1}},{key:"readVinylTrack",value:function(e,t){for(var n=[],a=t,r=t;r;){var c=e.getPixel(r);n.push(c);var i=this.findNextPixel(e,a,r);a=r,r=i}return n}},{key:"findNextPixel",value:function(e,t,n){for(var a=-1;a<=1;a++)for(var r=-1;r<=1;r++){var c={x:n.x+a,y:n.y+r};if(!j(c,t)&&!j(c,n)&&e.isInBounds(c)){var i=e.getPixel(c);if(255===i.alpha)return c}}return null}}]),e}(),P=function(e){Object(y.a)(n,e);var t=Object(p.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"getPixels",value:function(e){for(var t=[],n=0;n<e.length;n+=3)t.push({red:e[n],green:e[n+1]||0,blue:e[n+2]||0,alpha:255});return t}},{key:"getBytes",value:function(e){for(var t=new Uint8Array(3*e.length),n=0;n<e.length;n++){var a=e[n];t[3*n]=a.red,t[3*n+1]=a.green,t[3*n+2]=a.blue}return t}}]),n}(C),L=function(e){Object(y.a)(n,e);var t=Object(p.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"getPixels",value:function(e){var t=[];return e.forEach((function(e){return t.push(w(e))})),t}},{key:"getBytes",value:function(e){return new Uint8Array(e.map((function(e){return e.red})))}}]),n}(C);!function(e){e[e.GRAY_SPIRAL=0]="GRAY_SPIRAL",e[e.RAINBOW_SPIRAL=1]="RAINBOW_SPIRAL"}(A||(A={}));var E=(I={},Object(O.a)(I,A.GRAY_SPIRAL,L),Object(O.a)(I,A.RAINBOW_SPIRAL,P),I);function M(e){var t=E[e];if(!t)throw new Error("Unknown encoding");return new t}function B(e){var t=e.getPixel(0,0),n=e.getPixel(1,0);if(86!==t.red||105!==t.green||120!==t.blue||121!==n.red||108!==n.green)throw new Error("Invalid header");return M(n.blue)}var D=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(),o=Object(u.a)(i,2),d=o[0],h=o[1],j=Object(a.useState)(),v=Object(u.a)(j,2),O=v[0],y=v[1],p=Object(a.useState)(),m=Object(u.a)(p,2),w=m[0],k=m[1],N=Object(a.useState)(!1),S=Object(u.a)(N,2),R=S[0],I=S[1];Object(a.useEffect)((function(){var e=new Image;e.addEventListener("load",(function(){h(e)})),e.src=r}),[r]),Object(a.useEffect)((function(){var t,n=null===(t=e.current)||void 0===t?void 0:t.getContext("2d");d&&n&&(n.clearRect(0,0,n.canvas.width,n.canvas.height),n.drawImage(d,0,0),y(new b(n)))}),[d]);var A=Object(a.useCallback)((function(e){var t,n=null===(t=e.currentTarget.files)||void 0===t?void 0:t.item(0);if(n){k(void 0);var a=new FileReader;a.addEventListener("load",(function(){"string"===typeof a.result&&c(a.result)})),a.readAsDataURL(n)}}),[]),C=Object(a.useCallback)(Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=2;break}return e.abrupt("return");case 2:if(k(void 0),t=B(O)){e.next=6;break}return e.abrupt("return");case 6:return I(!0),e.t0=k,e.next=10,t.decode(O);case 10:e.t1=e.sent,(0,e.t0)(e.t1),I(!1);case 13:case"end":return e.stop()}}),e)}))),[O]);return Object(f.jsx)("main",{className:"flex-center",children:Object(f.jsxs)("div",{className:"controls wide",children:[Object(f.jsx)("input",{type:"file",accept:"image/*",onChange:A,className:"row"}),Object(f.jsx)("div",{className:"center",children:Object(f.jsx)("canvas",{ref:e,className:"row",width:null===d||void 0===d?void 0:d.width,height:null===d||void 0===d?void 0:d.height,style:{maxWidth:null===d||void 0===d?void 0:d.width,maxHeight:null===d||void 0===d?void 0:d.height}})}),Object(f.jsxs)("button",{className:"big",style:{marginBottom:12},onClick:C,disabled:!O,children:["Read ",Object(f.jsx)(x,{icon:"music"})]}),R&&Object(f.jsxs)("div",{className:"big",children:[Object(f.jsx)(x,{icon:"spinner",className:"fa-pulse"})," Loading..."]}),Object(f.jsx)("div",{className:"center",children:w&&Object(f.jsx)(g,{type:w.type,data:w.data})})]})})},T=function(){return Object(f.jsx)("a",{className:"github-corner",href:"https://github.com/LucaScorpion/vixyl",target:"_blank",rel:"noopener noreferrer",children:Object(f.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:80,height:80,viewBox:"0 0 250 250",fill:"#EEE",children:[Object(f.jsx)("path",{d:"M0 0l115 115h15l12 27 108 108V0z",fill:"#222"}),Object(f.jsx)("path",{className:"octo-arm",d:"M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16"}),Object(f.jsx)("path",{className:"octo-body",d:"M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z"})]})})},V=n(14),W=n(5),F=function(e){var t=e.href,n=e.children;return Object(f.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:n})},_=n.p+"static/media/tweet.816bc4c4.png",G=n.p+"static/media/tdfw_new.8c530ec7.png",U=function(){return Object(f.jsxs)("main",{style:{maxWidth:900},children:[Object(f.jsx)("h3",{children:"Vixyl lets you read and create pixel art vinyls."}),Object(f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(f.jsxs)("div",{children:[Object(f.jsxs)("p",{children:["This project started thanks to a ",Object(f.jsx)(F,{href:"https://twitter.com/notch/status/490927655806853120",children:"tweet by Notch"}),"."]}),Object(f.jsx)("p",{children:'Encoded in the spiral is an 8-bit mono 4kHz audio track, containing 3 seconds of the song "Turn Down for What". When I initially saw this I hacked together a tool in C# with Windows Forms that would allow you to read the image, and later I even added support for creating your own vinyls from a sound file.'}),Object(f.jsx)("p",{children:"Then, a few years later, I came across it again and figured it would be fun to completely redo the project with some major improvements, primarily making it browser-based so anyone can easily use it. A couple of coding sessions and a whole bunch of scope creep later, Vixyl was born!"})]}),Object(f.jsx)("div",{style:{marginLeft:64},children:Object(f.jsx)("img",{src:_,alt:"Notch's tweet",style:{width:260}})})]}),Object(f.jsx)("p",{children:"Vixyl implements the idea of encoding binary data into an image in a more generic way. That means you can use it to encode any file into a vinyl. That does mean that the original image doesn't work with Vixyl, but I did make an updated version that does:"}),Object(f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(f.jsx)("div",{style:{marginRight:64},children:Object(f.jsx)("img",{src:G,alt:"Turn Down For What vinyl"})}),Object(f.jsx)("div",{children:Object(f.jsxs)("p",{children:["Try it out for yourself! Go to ",Object(f.jsx)(V.b,{to:"/read",children:"Read vinyl"})," to try reading this image, or go to ",Object(f.jsx)(V.b,{to:"/create",children:"Create vinyl"})," to create your own vinyl from a song, image, or any other file."]})})]}),Object(f.jsx)("h3",{children:"Source code, issues, or contributing?"}),Object(f.jsxs)("p",{children:["This project is completely open source and available ",Object(f.jsx)(F,{href:"https://github.com/LucaScorpion/vixyl",children:"on GitHub"}),"! If you encounter any bugs, have suggestions, or otherwise want to contribute, feel free to check out the repo."]})]})},Y=n(15),z=function(e){var t=e.value,n=e.onChange,a=e.text;e.defaultValue;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("input",{id:a,type:"checkbox",checked:t,onChange:function(e){return n(e.currentTarget.checked)}}),Object(f.jsx)("label",{htmlFor:a,children:a})]})},H=n(99),Q=function(e){var t=e.value,n=e.onChange,a=e.text;e.defaultValue;return Object(f.jsxs)(f.Fragment,{children:[a,Object(f.jsx)(H.a,{color:t,onChange:function(e){return n(e.rgb)}})]})},J=function(e){switch(e.type){case"boolean":return Object(f.jsx)(z,Object(Y.a)({},e));case"color":return Object(f.jsx)(Q,Object(Y.a)({},e))}},q=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(A.RAINBOW_SPIRAL),o=Object(u.a)(i,2),d=o[0],h=o[1],j=Object(a.useState)(),b=Object(u.a)(j,2),v=b[0],g=b[1],y=Object(a.useState)(),p=Object(u.a)(y,2),m=p[0],w=p[1],k=Object(a.useState)({width:0,height:0}),N=Object(u.a)(k,2),R=N[0],I=N[1],C=Object(a.useState)(),P=Object(u.a)(C,2),L=P[0],E=P[1],B=Object(a.useState)(""),D=Object(u.a)(B,2),T=D[0],V=D[1],W=Object(a.useState)(!1),F=Object(u.a)(W,2),_=F[0],G=F[1];Object(a.useEffect)((function(){var e=M(d);g(e);var t={};e.getEncodeForm().forEach((function(e){m&&null!=m[e.key]?t[e.key]=m[e.key]:t[e.key]=e.defaultValue})),w(t)}),[d]);var U=Object(a.useCallback)((function(e){var t,n=null===(t=e.currentTarget.files)||void 0===t?void 0:t.item(0);if(n){c(void 0),V(""),I({width:0,height:0});var a=new FileReader;a.addEventListener("load",(function(){a.result&&"object"===typeof a.result&&c({type:n.type,data:new Uint8Array(a.result)})})),a.readAsArrayBuffer(n)}}),[]),z=Object(a.useCallback)(Object(l.a)(s.a.mark((function t(){var n,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=null===(n=e.current)||void 0===n?void 0:n.getContext("2d"),r&&a&&v){t.next=3;break}return t.abrupt("return");case 3:return G(!0),t.next=6,v.encode(r,{setCanvasProps:function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e){E((function(){return e}))})),I(t),e.next=4,n;case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),form:m});case 6:S(a,0,0,{red:86,green:105,blue:120,alpha:255}),S(a,1,0,{red:121,green:108,blue:d,alpha:255}),V(a.canvas.toDataURL()),G(!1);case 10:case"end":return t.stop()}}),t)}))),[r,d,v,m]);return Object(a.useEffect)((function(){L&&L()}),[R]),Object(f.jsxs)("main",{className:"flex-center",children:[Object(f.jsxs)("div",{className:"controls",children:[Object(f.jsx)("input",{type:"file",className:"row",onChange:U}),Object(f.jsxs)("select",{className:"row",onChange:function(e){return h(parseInt(e.currentTarget.value,10))},value:d,children:[Object(f.jsx)("option",{value:A.GRAY_SPIRAL,children:"Gray Spiral"}),Object(f.jsx)("option",{value:A.RAINBOW_SPIRAL,children:"Rainbow Spiral"})]}),m&&v&&v.getEncodeForm().map((function(e){return Object(f.jsx)("div",{className:"row",children:Object(f.jsx)(J,Object(Y.a)(Object(Y.a)({},e),{},{value:m[e.key],onChange:function(t){return w((function(n){return Object(Y.a)(Object(Y.a)({},n),{},Object(O.a)({},e.key,t))}))}}))},e.key)})),Object(f.jsxs)("button",{className:"big",onClick:z,disabled:!r,children:["Create ",Object(f.jsx)(x,{icon:"compact-disc"})]}),T&&Object(f.jsx)("a",{download:"vinyl.png",href:T,children:Object(f.jsxs)("button",{className:"big",children:["Save ",Object(f.jsx)(x,{icon:"image"})]})}),_&&Object(f.jsxs)("div",{className:"big",children:[Object(f.jsx)(x,{icon:"spinner",className:"fa-pulse"})," Loading..."]})]}),Object(f.jsx)("div",{children:Object(f.jsx)("canvas",Object(Y.a)(Object(Y.a)({},R),{},{ref:e}))})]})},K=function(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("header",{children:[Object(f.jsx)(V.b,{to:"/",children:Object(f.jsx)("h1",{children:"Vixyl"})}),Object(f.jsxs)("nav",{children:[Object(f.jsx)(V.c,{exact:!0,to:"/",children:"About"}),Object(f.jsx)(V.c,{exact:!0,to:"/read",children:"Read vinyl"}),Object(f.jsx)(V.c,{exact:!0,to:"/create",children:"Create vinyl"})]})]}),Object(f.jsx)(T,{}),Object(f.jsx)("div",{className:"content",children:Object(f.jsxs)(W.d,{children:[Object(f.jsx)(W.b,{exact:!0,path:"/",component:U}),Object(f.jsx)(W.b,{exact:!0,path:"/read",component:D}),Object(f.jsx)(W.b,{exact:!0,path:"/create",component:q}),Object(f.jsx)(W.a,{to:"/"})]})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(V.a,{children:Object(f.jsx)(K,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[217,1,2]]]);
//# sourceMappingURL=main.27911886.chunk.js.map